"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[127],{8621:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var i=function(){var t=this,e=this,s=e.$createElement,i=e._self._c||s;return i("div",{staticClass:"bg"},[i("div",{staticStyle:{"white-space":"nowrap"}},[i("el-button",{attrs:{type:"primary",circle:""},on:{click:function(t){return e.$router.go(-1)}}},[i("i",{staticClass:"el-icon-arrow-left"})]),i("el-button",{attrs:{type:"primary",circle:""},on:{click:function(){t.input=!t.input}}},[i("i",{staticClass:"el-icon-s-comment"})]),e._v(e._s(this.$route.query.Name)+" ")],1),i("transition-group",{attrs:{name:"animate__animated animate__slideInLeft","enter-active-class":"animate__backInLeft"}},e._l(e.records,(function(t,s){return e.records[0].Account?i("el-row",{key:t.时间,attrs:{gutter:20}},[i("el-col",{attrs:{span:3,offset:4}},[i("div",{staticClass:"content"},[i("div",{staticClass:"acinfo"},[i("div",{staticClass:"touxiang"},[t.头像?i("el-image",{attrs:{src:t.头像}}):e._e()],1),i("div",{staticClass:"info"},[i("div",{staticClass:"name"},[e._v(e._s(t.昵称)),i("br")]),i("div",{staticClass:"time"},[e._v(e._s(e.time(t.时间)))])])]),i("div",{staticClass:"comment"},[e._v(e._s(t.短评))])])]),i("el-col",{attrs:{span:3,push:4}},[i("div",{staticClass:"REDA"},[t.打分?i("REDA",{attrs:{data:t.打分,editable:0,tiny:!0}}):e._e()],1)])],1):e._e()})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.records.length>=5,expression:"records.length>=5"}],staticClass:"footer"},[e._v("加载更多")]),i("div",{staticStyle:{"min-width":"1060px",position:"sticky",bottom:"0",background:"rgba(0,0,0,0.6)"}},[e.input?i("el-row",[i("el-col",{attrs:{span:6}},[i("el-input",{attrs:{type:"textarea",rows:13,placeholder:"请输入内容"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1),i("el-col",{attrs:{span:14}},[i("div",{staticStyle:{position:"relative",width:"400px"}},[i("REDA",{attrs:{editable:1}})],1)]),i("el-col",{attrs:{span:4}},[i("el-button",{attrs:{type:"primary",circle:""},on:{click:e.throsub}},[i("i",{staticClass:"el-icon-check"})]),i("el-button",{attrs:{type:"danger",circle:""},on:{click:function(){t.input=!t.input}}},[i("i",{staticClass:"el-icon-delete"})])],1)],1):e._e()],1)],1)},o=[],n=s(650),r={name:"RD",computed:{throsub(){let t=this.throlote(this.sub,1e3);return t},infinitesub(){let t=this.throlote(this.infinitetest,30);return t}},created(){this.$bus.$on("RC",(t=>{this.record=t})),this.update()},mounted(){this.lazyload()},activated(){0==this.records.length&&this.update()},data(){return{records:[],comment:"",input:0,record:"80,80,80,80,80",timenow:moment().year(2021),infinitetimes:0}},methods:{lazyload(){console.log("lzload");const t=function(t,e){if(t[0].isIntersecting){console.log("infinite load"),this.infinitesub()}}.bind(this),e=document.querySelector("#rightin"),s=new IntersectionObserver(t,{root:e,threshold:1}),i=document.querySelector(".footer");s.observe(i)},time(t){return moment(t).format("YYYY-M-D H:mm:ss")},throlote(t,e){let s=0;return function(){let i=Date.now();i-s>e?(t.call(this,arguments),s=Date.now()):console.log(`节流,${e-i+s}ms后恢复`)}},sub(){let t={};Object.assign(t,this.records[0]);let e=this.$store.state.AC[0]?this.$store.state.AC[0]:{},s={Account:e.Account?e.Account:"uk",UID:e.UID?e.UID:"uk","头像":e.头像?e.头像:"http://r.photo.store.qq.com/psc?/V53ZbwIa09kn2Q0usRF00zmUxK3YRSXK/45NBuzDIW489QBoVep5mcVunig8u.neSyFzJnAVs2NYv4wCXzHcQ3BzquOmk*KqXAfzHAWskCYzYX.5*g1FzXAvshHSxLOXPnZ9ubScu2RA!/r","打分":this.record,"时间":moment().format(),"昵称":e.昵称?e.昵称:"匿名用户","短评":this.comment};Object.assign(t,s),this.$store.dispatch("addrecord",t),this.update()},infinitetest(){let t={};Object.assign(t,this.records[0]);let e=this.$store.state.AC[0]?this.$store.state.AC[0]:{},s={Account:e.Account?e.Account:"uk",UID:e.UID?e.UID:"uk","头像":e.头像?e.头像:"http://r.photo.store.qq.com/psc?/V53ZbwIa09kn2Q0usRF00zmUxK3YRSXK/45NBuzDIW489QBoVep5mcVunig8u.neSyFzJnAVs2NYv4wCXzHcQ3BzquOmk*KqXAfzHAWskCYzYX.5*g1FzXAvshHSxLOXPnZ9ubScu2RA!/r","打分":this.record,"时间":this.timenow.subtract(this.infinitetimes,"seconds").format("YYYY-M-D H:mm:ss"),"昵称":"无限加载测试","短评":"无限加载测试"};this.infinitetimes++,Object.assign(t,s),this.$store.dispatch("addrecord",t),this.update()},update(){this.records=[],0==this.$store.state.Record.length&&this.$router.replace("/Record");for(let t of this.$store.state.Record)t.片号==this.$route.query.No&&(this.records.push(t),this.records.sort(((t,e)=>moment(e.时间).format("X")-moment(t.时间).format("X"))))}},components:{REDA:n.Z}},c=r,a=s(1001),l=(0,a.Z)(c,i,o,!1,null,"6ce58b6f",null),u=l.exports}}]);